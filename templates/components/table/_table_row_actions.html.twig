{% set default_btn_class = default_btn_class|default('btn btn-outline-primary btn-sm') %}

{% for action in actions %}
    {% if action.route is defined %}
        {# params management #}
        {% set params = action.params|default({}) %}
        {% for key, path in action.param_map|default({ id: 'id' }) %}
            {% set value = attribute_chain(item, path) %}
            {% set params = params|merge({ (key): value }) %}
        {% endfor %}

        {# Icon management #}
        {% set icon = action.icon|default(null) %}
        {% if icon %}
            {% set icon_class = icon starts with 'bi ' ? icon : 'bi ' ~ (icon starts with 'bi-' ? icon : 'bi-' ~ icon) %}
        {% endif %}

        {% set is_delete = action.method is defined ? action.method|upper in ['POST','DELETE'] : (action.route ends with '_delete') %}

        {% if is_delete %}
            <button
                type="button"
                class="btn btn-outline-danger btn-sm"
                data-action="click->modal-confirmation#open"
                data-modal-confirmation-action-value="{{ path(action.route, params) }}"
                data-modal-confirmation-token-value="{{ csrf_token('delete' ~ (params.id ?? attribute_chain(item, 'id'))) }}"
                data-modal-confirmation-message-value="Êtes-vous sûr de vouloir supprimer cet élément ?"
                title="Supprimer cet élément">
                <i class="bi bi-trash"></i>
            </button>
        {% else %}
            <a href="{{ path(action.route, params) }}"
               class="{{ action.class|default(default_btn_class) }}"
               title="{{ action.label|default('') }}"
               aria-label="{{ action.label|default('') }}">
                {% if icon %}<i class="{{ icon_class }}"></i>{% endif %}
            </a>
        {% endif %}

    {% endif %}
{% endfor %}
