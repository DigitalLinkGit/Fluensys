{% set table_id = 'show_table_' ~ random() %}

<table class="table table-bordered align-middle" id="{{ table_id }}">
    <tbody>
    {% for field in fields %}
        {% set parts = field.field|split('.') %}
        {% set value = object %}
        {% for part in parts %}
            {% if value is not null and attribute(value, part) is defined %}
                {% set value = attribute(value, part) %}
            {% else %}
                {% set value = null %}
            {% endif %}
        {% endfor %}

        <tr>
            <th scope="row" class="text-nowrap">{{ field.label }}</th>
            <td>
                {% if value is iterable and value is not same as(value|keys) %}
                    {% for v in value %}
                        {% if v is not null %}
                            {% if attribute(v, 'label') is defined %}
                                {{ attribute(v, 'label') }}
                            {% elseif attribute(v, 'name') is defined %}
                                {{ attribute(v, 'name') }}
                            {% elseif attribute(v, 'id') is defined %}
                                Objet n°{{ attribute(v, 'id') }}
                            {% else %}
                                [objet]
                            {% endif %}
                            {% if not loop.last %}, {% endif %}
                        {% endif %}
                    {% endfor %}
                {% elseif value is same as(true) %}
                    Oui
                {% elseif value is same as(false) %}
                    Non
                {% elseif value is empty %}
                    <span class="text-muted">–</span>
                {% elseif attribute(value, 'label') is defined %}
                    {{ attribute(value, 'label') }}
                {% elseif attribute(value, 'name') is defined %}
                    {{ attribute(value, 'name') }}
                {% elseif attribute(value, 'id') is defined %}
                    Objet n°{{ attribute(value, 'id') }}
                {% else %}
                    {{ value|default('[non affichable]') }}
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
