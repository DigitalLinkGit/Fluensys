{% extends 'base.html.twig' %}

{% block title %}Log in!{% endblock %}

{% block body %}

    <div class="container" style="padding-top: 90px;">
        <div class="row justify-content-center">
            <div class="col-12 col-sm-10 col-md-7 col-lg-5 col-xl-4">
                <div class="card border shadow-sm">
                    <div class="card-body p-4">
                        <h1 class="h4 mb-3">Connexion</h1>
                        <p class="text-muted small mb-4">Veuillez saisir vos identifiants.</p>

                        {% if error %}
                            <div class="alert alert-danger">
                                {{ error.messageKey|trans(error.messageData, 'security') }}
                            </div>
                        {% endif %}

                        {% if app.user %}
                            <div class="alert alert-info d-flex justify-content-between align-items-center">
                            <span class="small">
                                Connecté en tant que <strong>{{ app.user.userIdentifier }}</strong>
                            </span>
                                <a class="btn btn-outline-secondary btn-sm" href="{{ path('app_logout') }}">
                                    Déconnexion
                                </a>
                            </div>
                        {% endif %}

                        <form method="post" class="mt-3">
                            <div class="mb-3">
                                <label for="username" class="form-label">Email</label>
                                <input
                                    type="email"
                                    value="{{ last_username }}"
                                    name="_username"
                                    id="username"
                                    class="form-control"
                                    autocomplete="email"
                                    required
                                    autofocus
                                >
                            </div>

                            <div class="mb-3">
                                <label for="password" class="form-label">Mot de passe</label>
                                <input
                                    type="password"
                                    name="_password"
                                    id="password"
                                    class="form-control"
                                    autocomplete="current-password"
                                    required
                                >
                            </div>

                            <input
                                type="hidden"
                                name="_csrf_token"
                                data-controller="csrf-protection"
                                value="{{ csrf_token('authenticate') }}"
                            >

                            <div class="d-flex justify-content-end align-items-center gap-2 mt-4">
                                {% include 'components/button/_btn.html.twig' with {
                                    btn: {
                                        type: 'submit',
                                        label: 'Connexion',
                                        icon: 'bi-box-arrow-in-right',
                                        class: 'btn btn-primary'
                                    }
                                } %}
                            </div>
                        </form>
                    </div>
                </div>

                <div class="text-center mt-3">
                    <a href="{{ path('app_home') }}" class="text-muted small text-decoration-none">
                        Retour à l’accueil
                    </a>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
